(function(){$(function(){var t,e,r,i,n,a;return i=$("#form-post"),a=1,n=i.find("#product_variations"),i.find(".content-frame-body > .c-field-group:last").after(n.removeClass("hidden")),n.on("click",".product_variation_photo_link",function(){var t;return t=$(this).prev(),$.fn.upload_filemanager({formats:"image",dimension:t.attr("data-dimension")||"",versions:t.attr("data-versions")||"",thumb_size:t.attr("data-thumb_size")||"",selected:function(e){return t.val(e.url)}}),!1}),e=n.find(".blank_product_variation").remove().clone().removeClass("hidden"),t=e.find(".sortable_values > li:first").remove().clone(),n.find(".add_new_variation").click(function(){var t;return t=e.clone().attr("data-id","new_"+(a+=1)),n.children(".variations_sortable").append(t),t.trigger("fill_variation_id"),r(),!1}),n.on("click",".add_new_value",function(){var e,r;return e=t.clone(),r=$(this).closest(".product_variation").attr("data-id"),e.find("input, select").each(function(){return $(this).attr("name",$(this).attr("name").replace("[]","["+r+"]")).removeAttr("id")}),$(this).closest(".variation_attributes").find(".sortable_values").append(e),e.find(".product_attribute_select").trigger("change"),!1}),n.on("change",".product_attribute_select",function(){var t,e,r,i,n,a,o;for(a=$(this).val(),n=$(this).closest(".row").find(".product_attribute_vals_select").html(""),i=[],e=0,r=PRODUCT_ATTRIBUTES.length;e<r;e++)t=PRODUCT_ATTRIBUTES[e],t.id==a?i.push(function(){var e,r,i,a;for(i=t.translated_values,a=[],e=0,r=i.length;e<r;e++)o=i[e],a.push(n.append('<option value="'+o.id+'">'+o.label.replace(/</g,"&lt;")+"</option>"));return a}()):i.push(void 0);return i}),n.on("fill_variation_id",".product_variation",function(){var t;return t=$(this).attr("data-id"),$(this).find("input, select").each(function(){return $(this).attr("name",$(this).attr("name").replace("[]","["+t+"]")).removeAttr("id")}),$(this).find(".sortable_values").sortable({handle:".val_sorter"})}),n.find(".sortable_values").sortable({handle:".val_sorter"}),n.find(".variations_sortable").sortable({handle:".variation_sorter",update:function(){return $(this).children().each(function(t){return $(this).find(".product_variation_position").val(t)})}}),n.on("click",".val_del",function(){return $(this).closest("li").fadeOut("slow",function(){return $(this).remove()}),!1}),n.on("click",".var_del",function(){return!!confirm(n.attr("data-confirm-msg"))&&($(this).closest(".product_variation").fadeOut("slow",function(){return $(this).remove(),r()}),!1)}),(r=function(){var t,e,r,a,o,s,d,l,c;if(t=["ecommerce_sku","ecommerce_price","ecommerce_weight","ecommerce_stock","ecommerce_qty","ecommerce_photos"],n.find(".product_variation").length>0){for(l=[],e=0,o=t.length;e<o;e++)a=t[e],d=i.find('.c-field-group .item-custom-field[data-field-key="'+a+'"]'),l.push(d.hide().find(".required").addClass("e_skip_required").removeClass("required"));return l}for(c=[],r=0,s=t.length;r<s;r++)a=t[r],d=i.find('.c-field-group .item-custom-field[data-field-key="'+a+'"]'),c.push(d.show().find(".e_skip_required").removeClass("e_skip_required").addClass("required"));return c})()})}).call(this);